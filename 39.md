# How do you update one table based on values from another?

General Problem

We have two tables:

##### Employees

| emp_id | name  | dept_id |
|--------|-------|---------|
| 1      | Alice | NULL    |
| 2      | Bob   | NULL    |

##### Departments

| dept\_id | dept\_name |
| -------- | ---------- |
| 10       | HR         |
| 20       | Finance    |


#### Goal: Update Employees.dept_id based on matching data from Departments.

## 1. Using UPDATE ... JOIN (MySQL, PostgreSQL)
```sql
UPDATE Employees e
JOIN Departments d 
   ON e.name = d.dept_name   -- match condition (example)
SET e.dept_id = d.dept_id;
```

- This updates dept_id in Employees wherever names match.

## 2. Using UPDATE ... FROM (SQL Server, PostgreSQL)
```sql
UPDATE e
SET dept_id = d.dept_id
FROM Employees e
JOIN Departments d
  ON e.name = d.dept_name;

```
- SQL Server & PostgreSQL support this form.

- FROM allows joins inside UPDATE.

## 3. Using a Subquery (Standard SQL – works in Oracle, MySQL, PostgreSQL)
```sql
UPDATE Employees e
SET dept_id = (
    SELECT d.dept_id
    FROM Departments d
    WHERE d.dept_name = e.name
)
WHERE EXISTS (
    SELECT 1
    FROM Departments d
    WHERE d.dept_name = e.name
);
```

- EXISTS ensures only matching rows get updated.

- Useful when the DB doesn’t support direct JOIN in UPDATE.

## 4. Oracle Syntax (MERGE)

- Oracle often uses MERGE for this type of operation:
```sql
MERGE INTO Employees e
USING Departments d
   ON (e.name = d.dept_name)
WHEN MATCHED THEN
   UPDATE SET e.dept_id = d.dept_id;

```
- MERGE can also insert new rows if not matched (UPSERT).

