# What is a Common Table Expression (CTE)? How is it different from a subquery?

- A Common Table Expression (CTE) is a temporary, named result set in SQL that you can reference within a SELECT, INSERT, UPDATE, or DELETE statement.
- It’s defined using the WITH keyword and exists only for the duration of the query.

## Syntax
```sql
WITH cte_name AS (
    SELECT ...
)
SELECT * 
FROM cte_name;
```
## Example
### Table: Orders

| order_id | customer | amount |
|----------|----------|--------|
| 1        | Alice    | 250    |
| 2        | Bob      | 300    |
| 3        | Alice    | 150    |


## Query using CTE:

```sql
WITH CustomerTotals AS (
    SELECT 
        customer,
        SUM(amount) AS total_amount
    FROM Orders
    GROUP BY customer
)
SELECT customer, total_amount
FROM CustomerTotals
WHERE total_amount > 200;
```
## Output:

| customer | total_amount |
|----------|--------------|
| Alice    | 400          |
| Bob      | 300          |

Difference: CTE vs. Subquery

| Feature           | CTE                                                                 | Subquery                                               |
|-------------------|---------------------------------------------------------------------|--------------------------------------------------------|
| Readability       | More readable and organized, especially for complex queries        | Can become hard to read when nested deeply             |
| Reusability       | Can be referenced multiple times within the same query             | Has to be repeated each time it’s needed               |
| Debugging         | Easier to debug and test parts                                     | Harder to isolate parts for debugging                  |
| Performance       | Generally similar performance to subqueries, but CTEs can be optimized in some cases | Similar performance                                    |
| Recursive Queries | Supports recursion (e.g., hierarchical data)                       | Does not directly support recursion                    |
